<html>
<head>
<title>Preload Image Page</title>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>

<script type="text/javascript">
	
	var baseURL = 'http://symvo.li/nicksimonis/images/photos/',
			priorities = {
				immediate: 0,
				high: 1,
				medium: 2,
				low: 3
			},
			currentP = 0,
			
			// Use JSON for image load list
			
			images = [
				[priorities.immediate, 'field.jpg'],
				[priorities.immediate, 'field2.jpg'],
				[priorities.immediate, 'field3.jpg'],
				[priorities.immediate, 'field4.jpg'],
				[priorities.high, 'beach.jpg'],
				[priorities.high, 'plane.jpg'],
				[priorities.medium, 'beach.jpg'],
				[priorities.medium, 'plane.jpg'],
				[priorities.low, 'beach.jpg'],
				[priorities.low, 'plane.jpg']
			],
			pre = new Array(),
			loaded = new Array(),
			count = 0,
			start = 0;
			
	var preloader = {
		init: function(){
			
			//start = preloader.microtime(true);
			//console.log(preloader.microtime() + ': Start loading!');
					
			preloader.loadQueue();
			preloader.check();
			
		},
		
		loadQueue: function(){
			for(i = 0; i < images.length; i++){ 
				if(currentP === images[i][0]){
					pre[i] = new Image();
					pre[i].src = baseURL + images[i][1];
					loaded[i] = false;
				}
			}
			currentP++;
			
			if(currentP > 4){
				// When all priority levels have been done
				return false;
			}
			
		},
		
		check: function(){
			
			if(count == pre.length){ 
				//console.log(preloader.microtime() + ': Done loading priority level: ' + currentP);
				//console.log('Duration: ' + (preloader.microtime(true) - start) + ' seconds');
				//start = preloader.microtime(true);
				
				if(currentP > priorities.immediate){
					$('#loading').text('Done!');
				}
				
				if(preloader.loadQueue() === false){
					// When all are done loading.
					return false;
				}
			}else{
				$('#loading').text('Loaded: ' + count);
			}
			
			for(i = 0; i <= pre.length; i++){
				
				if(pre[i] != undefined && pre[i].complete == true && loaded[i] == false){
					// Check if image i is loaded
				}
				
				if(loaded[i] == false && pre[i].complete){
					loaded[i] = true;
					count++;
				}
			}
			timerID = setTimeout("preloader.check()", 10);
		},
		
		microtime: function(get_as_float){
			get_as_float = (get_as_float == undefined) ? false : get_as_float;
			var unixtime_ms = new Date().getTime();
    	var sec = parseInt(unixtime_ms / 1000);
    	return get_as_float ? (unixtime_ms / 1000) : (unixtime_ms - (sec * 1000))/1000 + ' ' + sec;
		}
	};
	
	preloader.init();

</script>

</head>

<body>

	<span id="loading">Loading...</span>

</body>
</html>